# No-Show Penalty System - Complete Flow Diagram

**Last Updated:** February 11, 2026

---

## ğŸ“Š Customer Journey Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TIER 0: NORMAL (NEW CUSTOMER)                   â”‚
â”‚                                                                          â”‚
â”‚  No-Show Count: 0                                                        â”‚
â”‚  Status: âœ… Good Standing                                               â”‚
â”‚  Restrictions: None                                                      â”‚
â”‚  Can Book: âœ… Yes, anytime                                              â”‚
â”‚  RCN Redemption: 100% at earning shop, 20% elsewhere                    â”‚
â”‚  Deposit: Not required                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ âŒ 1st No-Show
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TIER 1: WARNING (FIRST OFFENSE)                     â”‚
â”‚                                                                          â”‚
â”‚  No-Show Count: 1                                                        â”‚
â”‚  Status: âš ï¸ Warning                                                     â”‚
â”‚  Restrictions: None                                                      â”‚
â”‚  Can Book: âœ… Yes, anytime                                              â”‚
â”‚  RCN Redemption: 100% at earning shop, 20% elsewhere                    â”‚
â”‚  Deposit: Not required                                                   â”‚
â”‚                                                                          â”‚
â”‚  ğŸ“§ Email Sent: "Friendly Reminder" (Educational tone)                  â”‚
â”‚  ğŸ“± In-App Notification: Warning issued                                 â”‚
â”‚                                                                          â”‚
â”‚  Recovery: Auto-recovery over time (future implementation)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ âŒ 2nd No-Show
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TIER 2: CAUTION (SECOND OFFENSE)                       â”‚
â”‚                                                                          â”‚
â”‚  No-Show Count: 2                                                        â”‚
â”‚  Status: ğŸŸ  Caution - Account Restricted                                â”‚
â”‚  Restrictions:                                                           â”‚
â”‚    â€¢ Must book at least 24 hours in advance                             â”‚
â”‚    â€¢ Limited to 80% RCN redemption per booking                          â”‚
â”‚  Can Book: âœ… Yes (with advance notice)                                 â”‚
â”‚  RCN Redemption: Max 80% per booking                                    â”‚
â”‚  Deposit: Not required                                                   â”‚
â”‚                                                                          â”‚
â”‚  ğŸ“§ Email Sent: "Account Restriction Notice"                            â”‚
â”‚  ğŸ“± In-App Notification: Restrictions applied                           â”‚
â”‚  ğŸš¨ Dashboard Banner: Warning banner displayed                          â”‚
â”‚                                                                          â”‚
â”‚  Recovery: Auto-recovery over time (future implementation)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ âŒ 3rd No-Show
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                TIER 3: DEPOSIT REQUIRED (THIRD OFFENSE)                  â”‚
â”‚                                                                          â”‚
â”‚  No-Show Count: 3-4                                                      â”‚
â”‚  Status: ğŸ”´ Deposit Required - Severe Restriction                       â”‚
â”‚  Restrictions:                                                           â”‚
â”‚    â€¢ $25 refundable deposit required for ALL bookings                   â”‚
â”‚    â€¢ Must book at least 48 hours in advance                             â”‚
â”‚    â€¢ Limited to 80% RCN redemption per booking                          â”‚
â”‚  Can Book: âœ… Yes (with deposit + advance notice)                       â”‚
â”‚  RCN Redemption: Max 80% per booking                                    â”‚
â”‚  Deposit: ğŸ’° $25 USD (refunded if customer shows up)                    â”‚
â”‚                                                                          â”‚
â”‚  ğŸ“§ Email Sent: "Deposit Required Notice" (critical alert)              â”‚
â”‚  ğŸ“± In-App Notification: Deposit requirement active                     â”‚
â”‚  ğŸš¨ Dashboard Banner: Red banner with deposit info                      â”‚
â”‚  ğŸ’³ Booking Flow: Deposit payment modal appears before booking          â”‚
â”‚                                                                          â”‚
â”‚  Recovery Path:                                                          â”‚
â”‚  âœ… Complete 3 successful appointments (show up on time)                â”‚
â”‚     â†’ Progress tracked in successful_appointments_since_tier3           â”‚
â”‚     â†’ After 3rd successful appointment: Auto-downgrade to Tier 2        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ âŒ 4th or 5th No-Show
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 TIER 4: SUSPENDED (FIFTH OFFENSE)                        â”‚
â”‚                                                                          â”‚
â”‚  No-Show Count: 5+                                                       â”‚
â”‚  Status: â›” SUSPENDED - Booking Banned                                  â”‚
â”‚  Restrictions:                                                           â”‚
â”‚    â€¢ Booking privileges suspended for 30 days                           â”‚
â”‚    â€¢ Cannot make any new bookings                                       â”‚
â”‚  Can Book: âŒ NO - Account suspended                                    â”‚
â”‚  RCN Redemption: N/A (cannot book)                                      â”‚
â”‚  Deposit: N/A (cannot book)                                             â”‚
â”‚  Suspension End Date: booking_suspended_until (30 days from last)       â”‚
â”‚                                                                          â”‚
â”‚  ğŸ“§ Email Sent: "Account Suspended" (30-day ban details)                â”‚
â”‚  ğŸ“± In-App Notification: Suspension notice                              â”‚
â”‚  ğŸš¨ Dashboard Banner: Red banner - "Account Suspended Until [DATE]"     â”‚
â”‚  ğŸš« Booking Flow: All booking buttons disabled                          â”‚
â”‚                                                                          â”‚
â”‚  Recovery Path:                                                          â”‚
â”‚  â° Wait 30 days â†’ Suspension expires automatically                      â”‚
â”‚     â†’ Auto-downgrade to Tier 3 (Deposit Required)                       â”‚
â”‚     â†’ Must follow Tier 3 rules to continue recovery                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Recovery Flow (Bottom to Top)

```
TIER 4: SUSPENDED (5+ no-shows)
    â”‚
    â”‚ â° TIME: Wait 30 days
    â”‚    - System checks: bookingSuspendedUntil < current_date
    â”‚    - Automatic: No manual action needed
    â”‚    - canBook changes from false â†’ true
    â”‚
    â†“
TIER 3: DEPOSIT REQUIRED (Still 5+ no-shows in history)
    â”‚
    â”‚ âœ… SUCCESS: Complete 3 successful appointments
    â”‚    - After each completed order: successful_appointments_since_tier3++
    â”‚    - Progress: 1/3... 2/3... 3/3 âœ“
    â”‚    - Automatic trigger: checkTierReset() downgrades to Tier 2
    â”‚    - deposit_required = false
    â”‚
    â†“
TIER 2: CAUTION (Still 5+ no-shows in history)
    â”‚
    â”‚ â° TIME: Auto-recovery over time (future implementation)
    â”‚    - OR: Dispute system (if wrongly marked)
    â”‚    - OR: Manual admin override
    â”‚
    â†“
TIER 1: WARNING (Still 5+ no-shows in history)
    â”‚
    â”‚ â° TIME: Auto-recovery over time (future implementation)
    â”‚
    â†“
TIER 0: NORMAL (Fully restored)
```

---

## ğŸ¯ Key Trigger Events

### Downward Triggers (Penalties)

| Event | Trigger | Database Action | System Response |
|-------|---------|----------------|-----------------|
| **1st No-Show** | Shop marks order as no-show | `no_show_count = 1`<br>`no_show_tier = 'warning'` | â€¢ Email: Friendly warning<br>â€¢ In-app notification<br>â€¢ History record created |
| **2nd No-Show** | Shop marks order as no-show | `no_show_count = 2`<br>`no_show_tier = 'caution'` | â€¢ Email: Restriction notice<br>â€¢ Dashboard banner appears<br>â€¢ 24hr booking rule enforced |
| **3rd No-Show** | Shop marks order as no-show | `no_show_count = 3`<br>`no_show_tier = 'deposit_required'`<br>`deposit_required = true` | â€¢ Email: Deposit requirement<br>â€¢ $25 deposit modal in booking flow<br>â€¢ 48hr booking rule enforced<br>â€¢ 80% RCN cap enforced |
| **5th No-Show** | Shop marks order as no-show | `no_show_count = 5`<br>`no_show_tier = 'suspended'`<br>`booking_suspended_until = NOW() + 30 days` | â€¢ Email: Suspension notice<br>â€¢ All booking buttons disabled<br>â€¢ Suspension countdown starts |

### Upward Triggers (Recovery)

| Event | Condition Check | Database Action | System Response |
|-------|----------------|-----------------|-----------------|
| **Suspension Expires** | `bookingSuspendedUntil < NOW()` | `canBook = true` (tier stays 'suspended' until reset) | â€¢ Customer can book again<br>â€¢ Still requires Tier 3 restrictions |
| **Successful Appointment** | Order status = 'completed'<br>Customer at Tier 3 | `successful_appointments_since_tier3++` | â€¢ Progress counter increments<br>â€¢ Dashboard shows progress |
| **Tier 3 â†’ Tier 2 Reset** | `successful_appointments_since_tier3 >= 3` | `no_show_tier = 'caution'`<br>`deposit_required = false`<br>`successful_appointments_since_tier3 = 0` | â€¢ Deposit requirement removed<br>â€¢ 24hr booking rule remains<br>â€¢ Email: Congratulations |

---

## ğŸ“§ Email Notification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  No-Show       â”‚
â”‚  Marked by     â”‚
â”‚  Shop          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OrderController.markNoShow()              â”‚
â”‚  â€¢ Records history                         â”‚
â”‚  â€¢ Increments no_show_count               â”‚
â”‚  â€¢ Database trigger updates tier          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NoShowPolicyService.recordNoShowHistory() â”‚
â”‚  â€¢ Inserts into no_show_history           â”‚
â”‚  â€¢ Trigger calculates new tier            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Get Updated Customer Status               â”‚
â”‚  â€¢ Fetch new tier from database           â”‚
â”‚  â€¢ Get shop policy settings               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€ Tier 1 (Warning) â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                  â”‚
         â”‚                                  â†“
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚ EmailService            â”‚
         â”‚                    â”‚ .sendNoShowTier1Warning â”‚
         â”‚                    â”‚                         â”‚
         â”‚                    â”‚ Subject: Important      â”‚
         â”‚                    â”‚ Reminder About Your     â”‚
         â”‚                    â”‚ Missed Appointment      â”‚
         â”‚                    â”‚                         â”‚
         â”‚                    â”‚ Tone: Educational,      â”‚
         â”‚                    â”‚ friendly reminder       â”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€ Tier 2 (Caution) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                   â”‚
         â”‚                                   â†“
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚ EmailService            â”‚
         â”‚                    â”‚ .sendNoShowTier2Caution â”‚
         â”‚                    â”‚                         â”‚
         â”‚                    â”‚ Subject: Account        â”‚
         â”‚                    â”‚ Restrictions Applied    â”‚
         â”‚                    â”‚                         â”‚
         â”‚                    â”‚ Content:                â”‚
         â”‚                    â”‚ â€¢ 24hr booking rule     â”‚
         â”‚                    â”‚ â€¢ How to avoid Tier 3   â”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€ Tier 3 (Deposit) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                   â”‚
         â”‚                                   â†“
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚ EmailService                â”‚
         â”‚                    â”‚ .sendNoShowTier3Deposit     â”‚
         â”‚                    â”‚ Required                    â”‚
         â”‚                    â”‚                             â”‚
         â”‚                    â”‚ Subject: Deposit Required   â”‚
         â”‚                    â”‚ for Future Bookings         â”‚
         â”‚                    â”‚                             â”‚
         â”‚                    â”‚ Content:                    â”‚
         â”‚                    â”‚ â€¢ $25 refundable deposit    â”‚
         â”‚                    â”‚ â€¢ 48hr booking rule         â”‚
         â”‚                    â”‚ â€¢ 80% RCN limit             â”‚
         â”‚                    â”‚ â€¢ How to restore (3 appts)  â”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€ Tier 4 (Suspended) â”€â”€â”€â”€â”€â”€â”€â”
                                             â”‚
                                             â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ EmailService               â”‚
                              â”‚ .sendNoShowTier4Suspended  â”‚
                              â”‚                            â”‚
                              â”‚ Subject: Account Suspended â”‚
                              â”‚ - 30 Day Booking Ban       â”‚
                              â”‚                            â”‚
                              â”‚ Content:                   â”‚
                              â”‚ â€¢ 30-day suspension        â”‚
                              â”‚ â€¢ Exact end date           â”‚
                              â”‚ â€¢ After suspension rules   â”‚
                              â”‚ â€¢ How to rebuild trust     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¬ Complete User Journey Examples

### Example 1: Perfect Customer (Never Escalates)

```
Day 1:  Customer books appointment âœ…
Day 2:  Customer shows up on time âœ…
        â†’ Stays at Tier 0 (Normal)
        â†’ No restrictions
        â†’ Full RCN redemption
```

---

### Example 2: One-Time Offender (Tier 1 â†’ Recovery)

```
Week 1: Customer books appointment
        Customer no-shows âŒ
        â†’ System: no_show_count = 1, tier = 'warning'
        â†’ Email: Friendly reminder sent
        â†’ Customer can still book normally

Week 2: Customer books again
        Customer shows up âœ…
        â†’ Stays at Tier 1 (Warning)

Week 4: (Future implementation)
        â†’ Auto-recovery to Tier 0 (Normal)
```

---

### Example 3: Repeat Offender â†’ Full Recovery

```
Month 1, Week 1:
  Appointment 1 â†’ No-show âŒ
  â†’ Tier 1 (Warning)
  â†’ Email: "Important reminder"
  â†’ No restrictions yet

Month 1, Week 2:
  Appointment 2 â†’ No-show âŒ
  â†’ Tier 2 (Caution)
  â†’ Email: "Account restrictions applied"
  â†’ Must book 24hr in advance
  â†’ Dashboard banner appears

Month 1, Week 3:
  Appointment 3 â†’ No-show âŒ
  â†’ Tier 3 (Deposit Required)
  â†’ Email: "Deposit required"
  â†’ Must pay $25 deposit for ALL future bookings
  â†’ Must book 48hr in advance
  â†’ Max 80% RCN redemption

Month 1, Week 4:
  Appointment 4 â†’ No-show âŒ
  â†’ Still Tier 3 (no_show_count = 4)

Month 2, Week 1:
  Appointment 5 â†’ No-show âŒ
  â†’ Tier 4 (SUSPENDED)
  â†’ Email: "Account suspended for 30 days"
  â†’ booking_suspended_until = 30 days from now
  â†’ All booking buttons disabled
  â†’ Red banner: "Suspended until March 15, 2026"

Month 2, Weeks 2-5:
  â†’ Customer cannot book (suspension active)
  â†’ Dashboard shows countdown

Month 3, Week 1: (Day 31)
  â†’ Suspension expires automatically
  â†’ canBook = true
  â†’ Customer returns at Tier 3 (Deposit Required)
  â†’ Must pay $25 deposit to book

Month 3, Week 2:
  Appointment 6 â†’ Books with $25 deposit
  Appointment 6 â†’ Shows up! âœ…
  â†’ System: successful_appointments_since_tier3 = 1/3
  â†’ Deposit refunded immediately
  â†’ Dashboard shows progress: "2 more successful appointments to restore account"

Month 3, Week 3:
  Appointment 7 â†’ Books with $25 deposit
  Appointment 7 â†’ Shows up! âœ…
  â†’ System: successful_appointments_since_tier3 = 2/3
  â†’ Deposit refunded
  â†’ Dashboard: "1 more successful appointment to restore account"

Month 3, Week 4:
  Appointment 8 â†’ Books with $25 deposit
  Appointment 8 â†’ Shows up! âœ…
  â†’ System: successful_appointments_since_tier3 = 3/3
  â†’ Deposit refunded
  â†’ AUTO-DOWNGRADE TRIGGERED âš¡
  â†’ Tier 3 â†’ Tier 2 (Caution)
  â†’ deposit_required = false
  â†’ Email: "Congratulations! Deposit no longer required"
  â†’ Dashboard banner: Green success message

Month 4:
  â†’ Customer at Tier 2 (Caution)
  â†’ Must book 24hr in advance (no deposit)
  â†’ 80% RCN redemption limit

Month 5-6: (Future implementation)
  â†’ Consistent good behavior
  â†’ Auto-recovery: Tier 2 â†’ Tier 1 â†’ Tier 0
  â†’ Fully restored to normal standing
```

---

### Example 4: Disputed No-Show (Future Feature)

```
Day 1:  Customer books appointment for 2:00 PM
Day 2:  Customer arrives at 1:55 PM (5 min early) âœ…
        BUT shop marks as no-show âŒ (mistake)
        â†’ no_show_count = 1
        â†’ Email sent

Day 3:  Customer disputes in dashboard
        â†’ Opens dispute form
        â†’ Provides reason: "I arrived 5 minutes early"
        â†’ Status: dispute_status = 'pending'

Day 4:  Shop reviews dispute
        â†’ Shop admits error
        â†’ Approves dispute
        â†’ Status: dispute_status = 'approved'
        â†’ System reverses no-show:
          â€¢ no_show_count = 0
          â€¢ no_show_tier = 'normal'
          â€¢ History record marked as disputed
        â†’ Customer notified: "Dispute approved"
```

---

## ğŸ› ï¸ Technical Flow (Behind the Scenes)

### No-Show Recording Flow

```
1. Shop Dashboard â†’ Click "Mark as No-Show" button
   â†“
2. MarkNoShowModal â†’ Enter notes (optional)
   â†“
3. POST /api/services/orders/:id/mark-no-show
   â†“
4. OrderController.markNoShow()
   â”œâ”€â†’ Validate: Order exists, status = 'paid'
   â”œâ”€â†’ Validate: User is shop owner
   â”œâ”€â†’ Update order: status = 'no_show', no_show = true
   â”œâ”€â†’ Call: NoShowPolicyService.recordNoShowHistory()
   â”‚   â”œâ”€â†’ Insert into no_show_history table
   â”‚   â”‚   â†“
   â”‚   â”‚   DATABASE TRIGGER FIRES âš¡
   â”‚   â”‚   â”œâ”€â†’ Increment customers.no_show_count
   â”‚   â”‚   â”œâ”€â†’ Calculate new tier based on count:
   â”‚   â”‚   â”‚   â€¢ 1 = 'warning'
   â”‚   â”‚   â”‚   â€¢ 2 = 'caution'
   â”‚   â”‚   â”‚   â€¢ 3-4 = 'deposit_required'
   â”‚   â”‚   â”‚   â€¢ 5+ = 'suspended'
   â”‚   â”‚   â”œâ”€â†’ Update customers.no_show_tier
   â”‚   â”‚   â”œâ”€â†’ Set customers.last_no_show_at = NOW()
   â”‚   â”‚   â”œâ”€â†’ If tier 3: deposit_required = true
   â”‚   â”‚   â”œâ”€â†’ If tier 4: booking_suspended_until = NOW() + 30 days
   â”‚   â†“
   â”œâ”€â†’ Get updated customer status
   â”œâ”€â†’ Send in-app notification (NotificationService)
   â”œâ”€â†’ Send tier-appropriate email (EmailService)
   â”‚   â”œâ”€â†’ Tier 1: sendNoShowTier1Warning()
   â”‚   â”œâ”€â†’ Tier 2: sendNoShowTier2Caution()
   â”‚   â”œâ”€â†’ Tier 3: sendNoShowTier3DepositRequired()
   â”‚   â””â”€â†’ Tier 4: sendNoShowTier4Suspended()
   â†“
5. Return updated customer status to frontend
   â†“
6. Shop Dashboard â†’ Modal shows success
   Customer Dashboard â†’ Notification appears
   Customer Email â†’ Notification email arrives
```

### Booking Flow with Tier Checks

```
1. Customer clicks "Book Service"
   â†“
2. Frontend: Call GET /api/customers/:address/no-show-status?shopId=xxx
   â†“
3. Backend: NoShowPolicyService.getCustomerStatus()
   â”œâ”€â†’ Query customer tier from database
   â”œâ”€â†’ Check if suspended: bookingSuspendedUntil > NOW()
   â”œâ”€â†’ Calculate restrictions based on tier
   â”œâ”€â†’ Return: { tier, canBook, requiresDeposit, minimumAdvanceHours, restrictions }
   â†“
4. Frontend: Check response
   â”œâ”€â†’ If canBook = false (Tier 4 - Suspended)
   â”‚   â””â”€â†’ Show error modal: "Account suspended until [date]"
   â”‚       â””â”€â†’ Block booking completely
   â”‚
   â”œâ”€â†’ If requiresDeposit = true (Tier 3)
   â”‚   â””â”€â†’ Open ServiceCheckoutModal
   â”‚       â”œâ”€â†’ Show deposit warning: "$25 refundable deposit required"
   â”‚       â”œâ”€â†’ Validate: Selected date/time >= 48 hours from now
   â”‚       â”‚   â””â”€â†’ If too soon: Show error "Must book at least 48 hours in advance"
   â”‚       â”œâ”€â†’ Show RCN redemption: Max 80%
   â”‚       â””â”€â†’ Proceed to Stripe payment (service + deposit)
   â”‚
   â”œâ”€â†’ If tier = 'caution' (Tier 2)
   â”‚   â””â”€â†’ Open ServiceCheckoutModal
   â”‚       â”œâ”€â†’ Show warning banner: "Must book 24 hours in advance"
   â”‚       â”œâ”€â†’ Validate: Selected date/time >= 24 hours from now
   â”‚       â””â”€â†’ Show RCN redemption: Max 80%
   â”‚
   â””â”€â†’ If tier = 'normal' or 'warning' (Tier 0-1)
       â””â”€â†’ Open ServiceCheckoutModal
           â””â”€â†’ No restrictions
```

### Order Completion â†’ Successful Appointment Recording

```
1. Customer shows up for appointment
   â†“
2. Shop clicks "Mark as Complete"
   â†“
3. POST /api/services/orders/:id/complete
   â†“
4. OrderController.markOrderComplete()
   â”œâ”€â†’ Update order: status = 'completed'
   â”œâ”€â†’ Check customer tier: Is it 'deposit_required'?
   â”‚   â†“ YES
   â”‚   â””â”€â†’ Call: NoShowPolicyService.recordSuccessfulAppointment()
   â”‚       â”œâ”€â†’ Increment: successful_appointments_since_tier3++
   â”‚       â”œâ”€â†’ Call: checkTierReset()
   â”‚       â”‚   â””â”€â†’ Check: successful_appointments_since_tier3 >= 3?
   â”‚       â”‚       â†“ YES
   â”‚       â”‚       â””â”€â†’ AUTO-DOWNGRADE âš¡
   â”‚       â”‚           â”œâ”€â†’ no_show_tier = 'caution'
   â”‚       â”‚           â”œâ”€â†’ deposit_required = false
   â”‚       â”‚           â”œâ”€â†’ successful_appointments_since_tier3 = 0
   â”‚       â”‚           â””â”€â†’ Send email: "Congratulations! Account restored"
   â”‚       â”‚
   â”‚       â””â”€â†’ If deposit was collected:
   â”‚           â””â”€â†’ Trigger Stripe refund
   â”‚               â””â”€â†’ Update deposit_transactions: status = 'refunded'
   â†“
5. Return success to frontend
```

---

## ğŸ“Š Database State Transitions

### customers Table Changes

```sql
-- Starting state: Normal customer
no_show_count: 0
no_show_tier: 'normal'
deposit_required: false
last_no_show_at: NULL
booking_suspended_until: NULL
successful_appointments_since_tier3: 0

-- After 1st no-show
no_show_count: 1
no_show_tier: 'warning'
deposit_required: false
last_no_show_at: '2026-02-11 14:30:00'
booking_suspended_until: NULL
successful_appointments_since_tier3: 0

-- After 2nd no-show
no_show_count: 2
no_show_tier: 'caution'
deposit_required: false
last_no_show_at: '2026-02-15 10:00:00'
booking_suspended_until: NULL
successful_appointments_since_tier3: 0

-- After 3rd no-show
no_show_count: 3
no_show_tier: 'deposit_required'
deposit_required: true â† Changed
last_no_show_at: '2026-02-20 16:45:00'
booking_suspended_until: NULL
successful_appointments_since_tier3: 0

-- After 5th no-show
no_show_count: 5
no_show_tier: 'suspended'
deposit_required: true
last_no_show_at: '2026-02-28 11:20:00'
booking_suspended_until: '2026-03-30 11:20:00' â† Changed (30 days)
successful_appointments_since_tier3: 0

-- After suspension expires (Day 31)
no_show_count: 5
no_show_tier: 'suspended' (still, until successful appointments)
deposit_required: true
last_no_show_at: '2026-02-28 11:20:00'
booking_suspended_until: '2026-03-30 11:20:00' â† Past date, so canBook = true
successful_appointments_since_tier3: 0

-- After 1st successful appointment at Tier 3
no_show_count: 5
no_show_tier: 'suspended'
deposit_required: true
last_no_show_at: '2026-02-28 11:20:00'
booking_suspended_until: '2026-03-30 11:20:00'
successful_appointments_since_tier3: 1 â† Incremented

-- After 3rd successful appointment
no_show_count: 5
no_show_tier: 'caution' â† AUTO-DOWNGRADED
deposit_required: false â† Changed
last_no_show_at: '2026-02-28 11:20:00'
booking_suspended_until: '2026-03-30 11:20:00'
successful_appointments_since_tier3: 0 â† Reset
```

---

## ğŸ¯ Summary

### Penalty Escalation (Fast)
- **1 no-show** â†’ Tier 1 (Warning) - Instant
- **2 no-shows** â†’ Tier 2 (Caution) - Instant
- **3 no-shows** â†’ Tier 3 (Deposit) - Instant
- **5 no-shows** â†’ Tier 4 (Suspended) - Instant

### Recovery Path (Gradual)
- **Tier 4 â†’ Tier 3**: 30 days waiting period
- **Tier 3 â†’ Tier 2**: 3 successful appointments
- **Tier 2 â†’ Tier 1**: Auto over time (future)
- **Tier 1 â†’ Tier 0**: Auto over time (future)

### Key Principles
âœ… **Automatic** - No manual intervention needed
âœ… **Fair** - Deposits are refundable, not punitive
âœ… **Progressive** - Warnings before severe penalties
âœ… **Recoverable** - Always a path back to good standing
âœ… **Transparent** - Customers see their status and restrictions
âœ… **Educational** - Email tone teaches better behavior

---

**File:** `/docs/features/NO_SHOW_PENALTY_FLOW.md`
**Version:** 1.0
**Last Updated:** February 11, 2026
